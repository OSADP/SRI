package sri.data.dao;

import java.sql.Timestamp;
import java.util.List;

import org.apache.ibatis.session.SqlSession;
import org.apache.ibatis.session.SqlSessionFactory;

import sri.data.TruckFeed;

public class TruckFeedDaoImpl implements TruckFeedDao {
	
	SqlSessionFactory sqlMapper = MyBatisConnectionFactory.getSqlSessionFactory();
	SqlSession session = sqlMapper.openSession(true);
	
	@Override
	public List<TruckFeed> listAllTrucks() {
		List<TruckFeed> truckFeed = null;
		
		try {
			truckFeed = session.selectList("sri.mapper.TruckFeed.listAllTruckFeed");
		} finally {
			session.close();
		}
		
		return truckFeed;
	}

	@Override
	public TruckFeed getTruckFeed(Timestamp timestamp) {
		TruckFeed truck = null;
		try {
			truck = session.selectOne("sri.mapper.TruckFeed.getTruckFeed", timestamp);
		} finally {
			session.close();
		}
		return truck;
	}

	@Override
	public TruckFeed getTruckFeed(String timestamp, String sequenceNumber, Integer siteId) {
		TruckFeed truck = null;
		try {
			TruckFeed ttf = new TruckFeed();
			ttf.setTimestamp(timestamp);
			ttf.setSiteId(siteId);
			ttf.setSequenceNumber(sequenceNumber);
			truck = session.selectOne("sri.mapper.TruckFeed.getTruckFeed", ttf);
		} finally {
			session.close();
		}
		return truck;
	}

	@Override
	public void insertTruckFeed(TruckFeed truckfeed) {
		try {
			session.insert("sri.mapper.TruckFeed.insertTruckFeed", truckfeed);
		} finally {
			session.close();
		}
	}

}
