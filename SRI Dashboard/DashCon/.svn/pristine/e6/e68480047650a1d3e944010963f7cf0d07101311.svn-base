

'use strict';


angular.module('sri.controller.SaferLookup', [])
	.controller('SaferLookupCTRL', ['$scope', '$http', '$rootScope', function( $scope, $http, $rootScope ) {
		$scope.truck = $scope.truck || {};
		$scope.saferLookup = $scope.saferLookup || {};
		
		function loadSafer( data ) {
			$rootScope.$broadcast('saferLookupSuccess', data );
		 	$scope.saferLookup.loading = false;
		}
		
		$scope.saferLookup.searchSafer = function() {
		 	if( $scope.saferLookup.usdotNumber != '' && $scope.saferLookup.usdotNumber != undefined ) {
			 	$scope.saferLookup.loading = true;
				$http.get('/DashCon/resources/safer/' + $scope.saferLookup.usdotNumber )
				.success( loadSafer )
				.error( function( res ) {
				 	$scope.saferLookup.loading = false;
				 	alert('SAFER Lookup: US DOT Number does not exist.');
				});
		 	}
		}
		
		$scope.saferLookup.clearInput = function($event) {
			$event.stopPropagation();
			$scope.saferLookup.usdotNumber = '';
			loadSafer();
		}
	}]);